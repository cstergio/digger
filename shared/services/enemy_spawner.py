import random
# Χρησιμοποιείται για την τυχαία επιλογή σημείου εμφάνισης εχθρού

from shared.model.enemy import Enemy
# Εισάγουμε την κλάση Enemy, δηλαδή το αντικείμενο του εχθρού του παιχνιδιού

from shared.model.types import MonsterForm
# Εισάγουμε τον τύπο MonsterForm που περιγράφει τη μορφή του εχθρού
# (π.χ. NOBBIN, HOBBIN κ.λπ.)


class EnemySpawner:
    """
    Η κλάση EnemySpawner είναι υπεύθυνη αποκλειστικά
    για τη δημιουργία (spawn) εχθρών στο παιχνίδι.

    Δεν ελέγχει AI, κίνηση ή συγκρούσεις.
    Απλώς:
    - επιλέγει ένα σημείο spawn
    - δημιουργεί έναν Enemy
    - ορίζει την αρχική του μορφή
    """

    def __init__(self, spawn_x, spawn_y):
        """
        Αρχικοποιεί το σύστημα δημιουργίας εχθρών.

        spawn_x, spawn_y:
        οι αρχικές συντεταγμένες (tile-based) όπου μπορούν
        να εμφανιστούν εχθροί.
        """

        # Η λίστα spawn_points περιέχει όλα τα επιτρεπτά σημεία εμφάνισης
        # Κάθε στοιχείο είναι ένα tuple (x, y)
        self.spawn_points = [(spawn_x, spawn_y)]

    def add_spawn_point(self, x, y):
        """
        Προσθέτει ένα νέο σημείο εμφάνισης εχθρών.

        Αυτό επιτρέπει στο παιχνίδι να έχει:
        - πολλαπλά spawn σημεία
        - πιο απρόβλεπτη συμπεριφορά εχθρών
        """

        # Προσθέτουμε το νέο σημείο στη λίστα
        self.spawn_points.append((x, y))

    def spawn(self):
        """
        Δημιουργεί και επιστρέφει έναν νέο εχθρό.

        Βήματα:
        1. Επιλέγει τυχαία ένα σημείο spawn
        2. Δημιουργεί αντικείμενο Enemy
        3. Ορίζει την αρχική μορφή του εχθρού
        4. Επιστρέφει τον εχθρό στο game loop
        """

        # Επιλέγουμε τυχαία ένα από τα διαθέσιμα spawn points
        x, y = random.choice(self.spawn_points)

        # Δημιουργούμε νέο Enemy στη θέση (x, y)
        enemy = Enemy("enemy", x, y)

        # Ορίζουμε ότι ο εχθρός ξεκινά ως NOBBIN
        # (δηλαδή η βασική, λιγότερο επικίνδυνη μορφή)
        enemy.form = MonsterForm.NOBBIN

        # Επιστρέφουμε τον έτοιμο εχθρό
        return enemy
